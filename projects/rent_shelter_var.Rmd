---
title: ' Report \break "Vector Autoregressive (VAR) Modeling for Shelter Population & Median rent asked in NYC" '
author: "**Studnet**  \nAhmed Albarqi  \n"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_depth: 3
    toc_float: true
    number_sections: true
    highlight: tango
    theme: default
    fig_caption: true
    df_print: tibble
  bookdown::pdf_document2:
    toc: false
    latex_engine: xelatex
    toc_depth: '3'
    number_sections: true
  bookdown: default
urlcolor: blue
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(kableExtra)
library(dynlm)
library(modelsummary)
library(ggplot2)
library(broom)
library(lmtest)
library(knitr)
library(MuMIn)
library(tseries)
library(forecast)
library(urca)
library(aTSA)
library(FinTS)
library(vars)
load("nyc_housing_shelter_datasets.RData")
## Store months as dates
df_final <- df_final %>%
  mutate(
    month = ymd(month)  
  ) %>%
  arrange(month)     
```


# Introdution 

Homelessness is one of New York City’s most persistent and structurally complex policy challenges. It has remained a central issue for successive governors, mayors, and political leaders, reflecting deep-rooted pressures in the city’s housing market and social safety net. Public discourse and empirical research have consistently linked homelessness to housing affordability, particularly rising rents, with higher rental costs often associated with increases in the number of individuals relying on shelter systems. Understanding the dynamic relationship between rental prices and shelter population is therefore critical for policymakers seeking to design effective housing and homelessness interventions.

This report conducts a detailed time-series analysis using a Vector Autoregressive (VAR) framework to examine the relationship between the monthly average shelter population and the median asking rent in New York City over the period from March 2021 to October 2025. The analysis explores how these two variables co-evolve over time and interact through their respective lag structures. In addition, the estimated model is used to generate forecasts for both variables over a 12-month horizon, from November 2025 to October 2026, providing insight into potential future trends in housing affordability and shelter demand.

## Research Questions

This report examines the dynamic relationship between housing affordability and homelessness in New York City using a Vector Autoregressive (VAR) framework. The analysis is guided by the following research questions:

1. **What is the dynamic relationship between median asking rents and the shelter population in New York City?**  
   How do changes in rental prices and shelter population co-evolve over time, and how does each variable respond to its own past values and those of the other variable?

2. **Do changes in median asking rents Granger-cause changes in the shelter population, and vice versa?**  
   To what extent do past movements in rents help predict future shelter demand, and is there evidence of feedback effects from shelter population changes to rental prices?

3. **What is the timing and magnitude of the shelter population’s response to rental price shocks?**  
   How quickly do shocks to housing affordability transmit to the shelter system, and are these effects short-lived or persistent?

# Data Sources and Description
The analysis relies on two primary variables: the monthly average number of individuals in homeless shelters and the median asking rent in New York City. While rental data are reported at a monthly frequency, the shelter population data are originally available on a daily basis. To ensure consistency across series, the daily shelter counts were aggregated to monthly averages.

## Individuals in Shelters
- **Definition:**
Daily numbers of individuals & families living in Department of Homeless Services (DHS) shelters.

- **Source:**
https://catalog.data.gov/dataset/dhs-daily-report

the data has been aggregated to a monthly average level

## Median Rent Asked
- **Definition:**
The exact monthly median rent asked among all rental listings available on StreetEasy at any point during the month/quarter/year.

- **Source:** https://tinyurl.com/yysmzxca

```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}

# Variables Identification

# Identify dates
start_year  <- year(min(df_final$month))
start_month <- month(min(df_final$month))

# Original Series
Ys <- ts(
  df_final[, c("total_shelter_avg", "median_rent")],
  frequency = 12,
  start = c(start_year, start_month))
colnames(Ys) <- c("shelter", "rent")

# log series
Ys_logs <- log(Ys)
colnames(Ys_logs) <- c("ln_shelter", "ln_rent")

# first differences of logs
Ys_dlogs <- diff(Ys_logs)
colnames(Ys_dlogs) <- c("dln_shelter", "dln_rent")

```

# Methodology

This section outlines the econometric framework used to estimate the VAR model and the diagnostic tests conducted to validate its assumptions. The objective is to model the growth rates of shelter population and median rent as functions of their own lagged values and the lagged values of the other variable.

Formally, the VAR system is specified as:

$$
Y_{1,t}
= \alpha_1
+ \sum_{i=1}^{p} \beta_{11,i} \, Y_{1,t-i}
+ \sum_{i=1}^{p} \beta_{12,i} \, Y_{2,t-i}
+ \varepsilon_{1,t}
$$

$$
Y_{2,t}
= \alpha_2
+ \sum_{i=1}^{p} \beta_{21,i} \, Y_{1,t-i}
+ \sum_{i=1}^{p} \beta_{22,i} \, Y_{2,t-i}
+ \varepsilon_{2,t}
$$
Where,

$$
Y_{1,t} = \Delta \ln(\text{Shelter Population}_t)
$$


$$
Y_{2,t} = \Delta \ln(\text{Median Rent}_t)
$$

## Stationarity Test

```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
# ADF test for Ys
adf_shelter_Ys <- adf.test(Ys[,"shelter"])
adf_rent_Ys    <- adf.test(Ys[,"rent"])
# ADF test for logs
adf_ln_shelter <- adf.test(Ys_logs[,"ln_shelter"])
adf_ln_rent    <- adf.test(Ys_logs[,"ln_rent"])
# ADF test for logs differenced
adf_dln_shelter <- adf.test(Ys_dlogs[,"dln_shelter"])
adf_dln_rent    <- adf.test(Ys_dlogs[,"dln_rent"])
```

Stationarity is a prerequisite for valid VAR estimation and forecasting. Time series that exhibit trends or unit roots can lead to spurious regression results if modeled in levels.

Visual inspection of the level series **Figure 1** indicates that both the monthly average shelter population and the median asking rent display trending behavior hence the series are non-stationarity. Consistent with this observation, Augmented Dickey–Fuller (ADF) test results reported in **Table 1** fail to reject the null hypothesis of a unit root for both series.


```{r shelter-rent-subfigures, echo=FALSE, fig.align='center', fig.cap="Figure 1: Shelter Population and Median Rent Over Time", fig.subcap=c("Shelter Population", "Median Rent Asked"), message=FALSE, warning=FALSE, out.height="40%", out.width="100%"}
par(mfrow = c(1, 2))

plot(Ys[, "shelter"],main = "Shelter Population",ylab = "Average Individuals in Shelters")

plot(Ys[, "rent"], main = "Median Rent Asked", ylab = "Median Rent Asked ($)")
```

```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
adf_results <- tribble(
  ~Variable,             ~Lag, ~ADF,    ~P_value,
  "Shelter Population",   0,   -0.34,   0.986,
  "Shelter Population",   1,   -1.20,   0.899,
  "Shelter Population",   2,   -1.03,   0.925,
  "Shelter Population",   3,   -1.63,   0.721,
  "Median Rent",          0,   -1.54,   0.755,
  "Median Rent",          1,   -2.42,   0.397,
  "Median Rent",          2,   -2.83,   0.238,
  "Median Rent",          3,   -2.49,   0.371)

adf_results %>% 
  kable(digits = 3, caption = "Table 1: ADF Test Results for Shelter Population and Median Rent") %>%
  kable_styling(latex_options = c("hold_position", "striped"))
```


Applying logarithmic transformations does not resolve the non-stationarity. As shown and confirmed by ADF results in **Table 2**, the log-transformed series remain non-stationary.

```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
adf_ln_results <- tribble(
  ~Variable,        ~Lag, ~ADF,     ~P_value,
  "Log Shelter",     0,   -0.437,   0.981,
  "Log Shelter",     1,   -1.377,   0.824,
  "Log Shelter",     2,   -1.179,   0.902,
  "Log Shelter",     3,   -1.742,   0.673,
  
  "Log Rent",        0,   -1.600,   0.731,
  "Log Rent",        1,   -2.310,   0.440,
  "Log Rent",        2,   -2.690,   0.290,
  "Log Rent",        3,   -2.290,   0.451
)

adf_ln_results %>%
  kable( digits = 3,
        caption = " Table 2: ADF Test Results (Log Variables) with Drift and Trend") %>%
  kable_styling(latex_options = c("hold_position", "striped"))
```


However, taking first differences of the logarithmic series yields stationary processes. **Figure 2** demonstrates stable behavior for both differenced series, and the ADF test results in **Table 3** reject the null hypothesis of non-stationarity at conventional significance levels. Consequently, both variables are treated as integrated of order one, I(1), and the VAR model is estimated using first differences of the log-transformed series.


```{r shelter-rent-growth-subfigures, echo=FALSE, fig.align='center', fig.cap="Figure 2: Growth Rates of Shelter Population and Median Rent", fig.subcap=c("Growth Rate of Shelter Population", "Growth Rate of Median Rent"), message=FALSE, warning=FALSE, out.height="40%", out.width="100%"}

par(mfrow = c(1, 2))

plot(Ys_dlogs[, "dln_shelter"],
     main = "Growth Rate of Shelter",
     ylab = "% Growth Rate")

plot(Ys_dlogs[, "dln_rent"],
     main = "Growth Rate of Rent",
     ylab = "% Growth Rate")
```


```{r echo=FALSE}
adf_dlog_results <- tribble(
  ~Variable,              ~Lag, ~ADF,    ~P_value,
  "Diff Log Shelter",      0,   -2.96,   0.0100,
  "Diff Log Shelter",      1,   -2.83,   0.0100,
  "Diff Log Shelter",      2,   -1.93,   0.0537,
  "Diff Log Shelter",      3,   -2.18,   0.0311,

  "Diff Log Rent",         0,   -3.91,   0.0100,
  "Diff Log Rent",         1,   -2.82,   0.0100,
  "Diff Log Rent",         2,   -2.87,   0.0100,
  "Diff Log Rent",         3,   -3.35,   0.0100
)

adf_dlog_results %>%
  kable( digits = 3,
        caption = "Table 3: ADF Test Results for Differenced Log Variables") %>%
  kable_styling(latex_options = c("hold_position", "striped"))
```



## Cointegration

```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}

# Choose lag length on logs
lag_sel <- VARselect(Ys_logs, lag.max = 6, type = "const")
k <- lag_sel$selection["AIC(n)"]
k <- as.numeric(k)  

cajo_eigen <- ca.jo(Ys_logs,type  = "eigen", ecdet = "const",K = k)
```


When multiple series are I(1), it is necessary to test for cointegration to determine whether a long-run equilibrium relationship exists. If such a relationship is present, a Vector Error Correction Model (VECM) would be more appropriate than a VAR in differences.

Johansen’s cointegration test was conducted using the log-level series. As reported in **Table 4**, the test statistic for the null hypothesis of no cointegration (r = 0) is 8.26, which is below the 5 percent critical value of 15.67. Therefore, the null hypothesis cannot be rejected, indicating no evidence of a stable long-run relationship between shelter population and median rent.

Given the absence of cointegration, a VAR model in first differences is appropriate, and a VECM specification is not warranted.


```{r echo=FALSE}

johansen_results <- tribble(
  ~Hypothesis, ~Test_Statistic, ~Crit_10pct, ~Crit_5pct, ~Crit_1pct,
  "r ≤ 1",        3.22,             7.52,        9.24,       12.97,
  "r = 0",        8.26,            13.75,       15.67,       20.20
)

johansen_results %>%
  kable(digits = 2,
        caption = "Table 4: Johansen Cointegration Test Results (Maximum Eigenvalue Statistic)") %>%
  kable_styling(latex_options = c("hold_position", "striped"))
```


# VAR Model

Since both series are I(1) and not cointegrated, a VAR model is estimated using the first differences of their logarithms. This specification captures short-run dynamics and interdependencies without imposing long-run equilibrium restrictions.

## Lags specifications

```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}

lag_sel_var <- VARselect(Ys_dlogs, lag.max = 6, type = "const")
lag_sel_var
p_choice <- lag_sel_var$selection["AIC(n)"]
p_choice <- as.numeric(p_choice)
p_choice
```

Optimal lag length was determined using information criteria, including AIC, SC, and HQ, as shown in **Table 5**. Based on the majority of criteria, the selected lag order is **VAR(4)**.



```{r echo=FALSE}

lag_selection <- tribble(
  ~Criterion, ~Lag1, ~Lag2, ~Lag3, ~Lag4, ~Lag5,
  "AIC", -1.581616e+01, -1.570725e+01, -1.607660e+01, -1.617376e+01, -1.607701e+01,
  "HQ",  -1.572827e+01, -1.556077e+01, -1.587153e+01, -1.591010e+01, -1.575475e+01,
  "SC",  -1.558451e+01, -1.532116e+01, -1.553608e+01, -1.547881e+01, -1.522762e+01
)

lag_selection %>%
  kable(digits = 4,
        caption = "Table 5: Lag Length Selection Criteria (AIC, HQ, SC(BIC))") %>%
  kable_styling(latex_options = c("hold_position", "striped"))
```



## Model Specifications

The VAR(4) model was estimated with a constant term. Full regression results are reported in **Table 6** of the Appendix. The estimated equations are summarized below:

```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
var_model <- VAR(Ys_dlogs, p= p_choice,type = "const")

summary(var_model)
```

$$
\begin{aligned}
\Delta \ln(\text{Shelter})_t =\;&
0.5490\,\Delta \ln(\text{Shelter})_{t-1}
+ 0.0047\,\Delta \ln(\text{Rent})_{t-1}
- 0.2178\,\Delta \ln(\text{Shelter})_{t-2}
- 0.0881\,\Delta \ln(\text{Rent})_{t-2} \\
&+ 0.2254\,\Delta \ln(\text{Shelter})_{t-3}
+ 0.4075\,\Delta \ln(\text{Rent})_{t-3} 
+ 0.1553\,\Delta \ln(\text{Shelter})_{t-4} 
+ 0.2424\,\Delta \ln(\text{Rent})_{t-4} \\
&- 0.00066.
\end{aligned}
$$

$$
\begin{aligned}
\Delta \ln(\text{Rent})_t =\;&
-0.0054\,\Delta \ln(\text{Shelter})_{t-1}
+ 0.4296\,\Delta \ln(\text{Rent})_{t-1}
- 0.2940\,\Delta \ln(\text{Shelter})_{t-2}
+ 0.3031\,\Delta \ln(\text{Rent})_{t-2} \\
&+ 0.5483\,\Delta \ln(\text{Shelter})_{t-3}
- 0.0647\,\Delta \ln(\text{Rent})_{t-3}
- 0.2996\,\Delta \ln(\text{Shelter})_{t-4}
- 0.2730\,\Delta \ln(\text{Rent})_{t-4} \\
&+ 0.00479.
\end{aligned}
$$


# Model Evaluation

To assess model validity and robustness, several diagnostic tests were conducted, focusing on residual behavior and autocorrelation.

## Residual Plot 

Visual inspection of the residual plots **Figure 3** suggests no systematic patterns, indicating the absence of heteroskedasticity or remaining serial correlation.


```{r shelter-rent-resid-subfigures, echo=FALSE, fig.align='center', fig.cap="Figure 3: Residuals Plots of VAR(4) Model", fig.subcap=c("Change in Shelter (Percentage Change)", "Change in Rent (Percentage Change)"), message=FALSE, warning=FALSE, out.height="40%", out.width="100%"}

var_resid <- residuals(var_model)

par(mfrow = c(1, 2))

plot(var_resid[, "dln_shelter"], type = "l", main = " Shelter Residual Plot", ylab = "Residual", xlab = "")

plot(var_resid[, "dln_rent"], type = "l", main = "Rent Residual Plot", ylab = "Residual", xlab = "")
```



## Portmanteau-test for Autocorrelation
```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
serial_test <- serial.test(var_model, lags.pt = 12, type = "PT.asymptotic")
chi_sq  <- serial_test$serial$statistic
df_val  <- serial_test$serial$parameter
p_val   <- serial_test$serial$p.value
serial_test
```
The Portmanteau test was applied to formally test for residual autocorrelation. As reported in **Table 7**, the test yields a p-value of **`r round(p_val,2)`**, which is greater than 0.05. Consequently, we fail to reject the null hypothesis of no serial correlation, supporting the adequacy of the model specification.

```{r echo=FALSE}
serial_tbl <- tibble(
  Statistic = chi_sq,
  Degrees_of_Freedom = df_val,
  P_Value = p_val
)

serial_tbl %>% kable(digits = 4, caption = "Table 7: Portmanteau Serial Correlation Test (12 Lags)") %>%
  kable_styling(latex_options = c("hold_position"))
```


## Autocorrelation Function (ACF) & Partiall Autocorrelation Function (PACF)

Further confirmation is provided by the ACF and PACF plots **Figure 4**, where all autocorrelation coefficients lie within the 95 percent confidence bounds. These results indicate that the residuals behave as white noise.




```{r acf-pacf-residuals, echo=FALSE, fig.align='center', fig.cap="Figure 4: ACF and PACF of Residuals for Shelter and Rent", fig.subcap=c("ACF: Shelter", "PACF: Shelter", "ACF: Rent", "PACF: Rent"), message=FALSE, warning=FALSE, out.height="80%", out.width="100%"}

var_resid <- residuals(var_model)

par(mfrow = c(2, 2))

acf(var_resid[, "dln_shelter"], main = "ACF:Shelter", lag.max = "10")

pacf(var_resid[, "dln_shelter"], main = "PACF: Shelter", lag.max = "10")

acf(var_resid[, "dln_rent"], main = "ACF: Rent", lag.max = "10")

pacf(var_resid[, "dln_rent"], main = "PACF: Rent ", lag.max = "10")

```




# Impulse Response Functions (IRF)

Impulse response functions illustrate how a one-time shock to one variable affects the current and future values of both variables in the system.

## Shelter Impulse Response Functions (IRF)

**Figure 5** shows that a 1 percent shock to shelter population growth has a persistent effect on itself, lasting approximately nine months and peaking in the fourth month after the shock. The same shock exerts a smaller and shorter-lived effect on rent growth, lasting around four months, with an initial positive response followed by a brief negative adjustment.



```{r irf-shelter, echo=FALSE, fig.cap="Figure 5: Impulse Response Functions to a Shock in Shelter Population", message=FALSE, warning=FALSE, out.width="100%"}
par(cex.axis = 0.7, cex.lab = 0.8)

irf_shelter <- irf(
  var_model,
  impulse  = "dln_shelter",
  response = c("dln_shelter", "dln_rent"),
  n.ahead  = 12,
  boot     = TRUE,
  ci       = 0.95
)

plot(irf_shelter)

par(cex.axis = 1, cex.lab = 1)

```


## Rent Impulse Response Functions (IRF)

**Figure 6** indicates that a 1 percent shock to median rent growth generates a delayed but positive response in shelter population growth, beginning in the second month and persisting for up to nine months, with the largest effect occurring in the fourth month. The impact on rent growth itself declines over time, turning negative after the fourth month and persisting for roughly ten periods.

```{r irf-rent, echo=FALSE, fig.cap="Figure 6: Impulse Response Functions to a Shock in Median Rent", message=FALSE, warning=FALSE, out.width="100%"}
par(cex.axis = 0.7, cex.lab = 0.8)

irf_rent <- irf(
  var_model,
  impulse  = "dln_rent",
  response = c("dln_shelter", "dln_rent"),
  n.ahead  = 12,
  boot     = TRUE,
  ci       = 0.95
)

plot(irf_rent)

par(cex.axis = 1, cex.lab = 1)

```



# Granger Causality


```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}

# Does dln_rent Granger-cause dln_shelter?
gc_rent_to_shelter <- causality(var_model, cause = "dln_rent")
p_rent_to_shelter  <- gc_rent_to_shelter$Granger$p.value

# Does dln_shelter Granger-cause dln_rent?
gc_shelter_to_rent <- causality(var_model, cause = "dln_shelter")
p_shelter_to_rent  <- gc_shelter_to_rent$Granger$p.value

```

Granger causality tests were conducted to examine whether lagged values of one variable improve the prediction of the other.

Results reported in **Table 8** show that changes in median rent Granger-cause changes in shelter population, with a p-value of **`r round(p_rent_to_shelter,2)`**. Similarly, changes in shelter population Granger-cause changes in median rent, with a p-value of **`r round(p_shelter_to_rent,2)`**.

These findings indicate bilateral (feedback) Granger causality, suggesting that both variables contain predictive information about each other’s future movements.


```{r echo=FALSE}
granger_tbl <- tribble(
  ~Null_Hypothesis,                                      ~F_Test, ~df1, ~df2, ~P_Value,
  "dln_rent does NOT Granger-cause dln_shelter",          4.2827,   4,    84,   0.003341,
  "dln_shelter does NOT Granger-cause dln_rent",          3.6639,   4,    84,   0.008439
)

granger_tbl %>%
  kable( digits = 4, caption = "Table 8: Granger Test Results") %>%
  kable_styling(latex_options = c("hold_position", "striped"))
```


# Forecasting

Using the estimated VAR(4) model, 12-month-ahead forecasts were generated for both variables. **Figure 7** in the appendix presents forecasts of percentage changes, which were subsequently transformed back into levels for interpretability.

**Table 9** in the appendix reports the forecasted values for both growth rates and levels, while **Figures 8 and 9** compare historical data with projected paths for shelter population and median rent. These forecasts provide insight into expected short-run dynamics in housing affordability and shelter demand, conditional on historical relationships.

```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
# 1. Forecast 12 months ahead
fcst <- predict(var_model, n.ahead = 12, ci = 0.95)


fcst$fcst$dln_shelter
fcst$fcst$dln_rent
```

```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
## Transform to main variables

last_ln_shelter <- tail(Ys_logs[,"ln_shelter"], 1)
last_ln_rent    <- tail(Ys_logs[,"ln_rent"], 1)


fc_shelter <- fcst$fcst$dln_shelter
fc_rent    <- fcst$fcst$dln_rent


cum_dln_shelter_mean  <- cumsum(fc_shelter[,"fcst"])
cum_dln_shelter_lower <- cumsum(fc_shelter[,"lower"])
cum_dln_shelter_upper <- cumsum(fc_shelter[,"upper"])

cum_dln_rent_mean  <- cumsum(fc_rent[,"fcst"])
cum_dln_rent_lower <- cumsum(fc_rent[,"lower"])
cum_dln_rent_upper <- cumsum(fc_rent[,"upper"])


ln_shelter_mean  <- as.numeric(last_ln_shelter) + cum_dln_shelter_mean
ln_shelter_lower <- as.numeric(last_ln_shelter) + cum_dln_shelter_lower
ln_shelter_upper <- as.numeric(last_ln_shelter) + cum_dln_shelter_upper

ln_rent_mean  <- as.numeric(last_ln_rent) + cum_dln_rent_mean
ln_rent_lower <- as.numeric(last_ln_rent) + cum_dln_rent_lower
ln_rent_upper <- as.numeric(last_ln_rent) + cum_dln_rent_upper


shelter_mean  <- exp(ln_shelter_mean)
shelter_lower <- exp(ln_shelter_lower)
shelter_upper <- exp(ln_shelter_upper)

rent_median  <- exp(ln_rent_mean)
rent_lower <- exp(ln_rent_lower)
rent_upper <- exp(ln_rent_upper)


horizon <- 1:length(shelter_mean)

level_forecasts <- data.frame(
  horizon = horizon,
  shelter_mean  = shelter_mean,
  shelter_lower = shelter_lower,
  shelter_upper = shelter_upper,
  rent_med     = rent_median,
  rent_lower    = rent_lower,
  rent_upper    = rent_upper
)

level_forecasts
```


```{r forecast, echo=FALSE, fig.cap="Forecasting", message=FALSE, warning=FALSE, out.width="100%"}

# dates
last_date <- max(df_final$month)
h <- nrow(level_forecasts)

future_dates <- seq(
  from = last_date %m+% months(1),
  by = "month",
  length.out = h
)

hist_shelter <- data.frame(
  month = df_final$month,
  shelter = df_final$total_shelter_avg,
  type = "Actual"
)

hist_rent <- data.frame(
  month = df_final$month,
  rent = df_final$median_rent,
  type = "Actual"
)


fc_shelter <- data.frame(
  month = future_dates,
  shelter = level_forecasts$shelter_mean,
  type = "Forecast"
)

fc_rent <- data.frame(
  month = future_dates,
  rent = level_forecasts$rent_med,
  type = "Forecast"
)


shelter_all <- rbind(hist_shelter, fc_shelter)
rent_all    <- rbind(hist_rent, fc_rent)

## plot
plot_shelter <- ggplot(shelter_all, aes(x = month, y = shelter, 
                                        color = type, linetype = type)) +
  geom_line(size = 1) +
  labs(
    title = "Figure 8: Shelter Population: Actual and Forecast",
    x = "Month",
    y = "Shelter Population"
  ) +
  scale_color_manual(values = c("Actual" = "black", "Forecast" = "blue")) +
  scale_linetype_manual(values = c("Actual" = "solid", "Forecast" = "dashed")) +
  theme_minimal()

print(plot_shelter)

## Plot

plot_rent <- ggplot(rent_all, aes(x = month, y = rent, 
                                  color = type, linetype = type)) +
  geom_line(size = 1) +
  labs(
    title = "Figure 9: Median Rent: Actual and Forecast",
    x = "Month",
    y = "Median Rent (USD)"
  ) +
  scale_color_manual(values = c("Actual" = "black", "Forecast" = "darkgreen")) +
  scale_linetype_manual(values = c("Actual" = "solid", "Forecast" = "dashed")) +
  theme_minimal()

print(plot_rent)


```

# Policy Implications 

The results of the VAR analysis carry several important implications for housing and homelessness policy in New York City. First, the presence of bilateral Granger causality between rent growth and shelter population growth suggests that homelessness should not be treated solely as a downstream consequence of housing market conditions. Instead, the findings indicate a feedback relationship, where pressures in the shelter system may also be associated with subsequent movements in the rental market. This reinforces the need for policy frameworks that jointly address housing affordability and homelessness, rather than treating them as separate domains governed by distinct agencies or interventions.

Second, the impulse response analysis highlights the timing and persistence of housing affordability shocks. A shock to median rent growth generates a delayed but sustained increase in shelter population growth, with effects lasting up to nine months. This lagged response implies that homelessness prevention policies must be forward-looking rather than reactive. By the time shelter entries rise sharply, affordability pressures have often been building for several months. Early warning indicators based on rental market dynamics—such as rapid rent acceleration in specific submarkets—could therefore be used to trigger preemptive interventions, including emergency rental assistance, eviction prevention, and short-term subsidies targeted at at-risk households.

Third, the persistence of shocks to shelter population growth suggests that once individuals enter the shelter system, elevated demand can remain for an extended period. This underscores the importance of policies that focus on reducing shelter inflows, not merely expanding shelter capacity. While short-run capacity expansions may be necessary during periods of stress, the results imply that without addressing the underlying affordability constraints, shelter demand is likely to remain elevated. Investments in rapid rehousing, housing vouchers, and supportive housing placements can help shorten shelter stays and reduce the persistence of shelter population growth following adverse shocks.

Finally, the forecast results indicate continued short-run volatility in both rent growth and shelter demand, reinforcing the value of integrating forecast-based planning into policy design. City agencies could use similar time-series models as part of an operational monitoring system to anticipate shelter demand and budgetary needs under different housing market scenarios. Such an approach would allow policymakers to better align housing production, rental assistance funding, and homelessness services with expected conditions, improving both fiscal planning and policy effectiveness.

Taken together, the findings suggest that effective homelessness policy in New York City requires a coordinated, anticipatory approach that links housing affordability interventions with shelter system management. Policies that stabilize rents, expand access to affordable housing, and intervene early in response to emerging affordability pressures are likely to be more effective than strategies that respond only after homelessness has already increased.

# Conclusion

This report developed and evaluated a VAR(4) model to analyze the dynamic relationship between monthly average shelter population and median asking rent in New York City. Using data from the Department of Homeless Services and StreetEasy, the analysis carefully addressed stationarity, cointegration, and model specification to avoid spurious inference. Diagnostic tests confirmed that the estimated model is well specified and free from residual autocorrelation.

The results reveal strong short-run interactions between rent growth and shelter population growth, including evidence of bilateral Granger causality. Impulse response analysis highlights the persistence and timing of shocks across variables, while the forecasts provide forward-looking insights into potential trends over the next year.

Overall, the findings underscore the tight and dynamic linkage between housing affordability and homelessness in New York City, reinforcing the importance of coordinated housing and social policy interventions to address shelter demand and housing market pressures simultaneously.

\newpage


# Appendix

## Figures & Tables



```{r var-forecast-subfigures, echo=FALSE, fig.align='center', fig.cap="12-Month Forecasts from the VAR(4) Model", fig.subcap=c("Forecast of dln(Shelter)", "Forecast of dln(Rent)"), message=FALSE, warning=FALSE, out.height="45%", out.width="100%"}

plot(fcst)
```


\newpage

\newpage


```{r echo=FALSE}
var_results <- tribble(
  ~Equation,        ~Variable,          ~Estimate,   ~Std_Error, ~t_value, ~P_value,
  
  "dln_shelter",   "dln_shelter.l1",    0.5490385,   0.1422799,   3.859,   0.000386,
  "dln_shelter",   "dln_rent.l1",       0.0046765,   0.1443535,   0.032,   0.974309,
  "dln_shelter",   "dln_shelter.l2",   -0.2177597,   0.1577336,  -1.381,   0.174720,
  "dln_shelter",   "dln_rent.l2",      -0.0880585,   0.1451774,  -0.607,   0.547409,
  "dln_shelter",   "dln_shelter.l3",    0.2253969,   0.1579747,   1.427,   0.161032,
  "dln_shelter",   "dln_rent.l3",       0.4075433,   0.1474321,   2.764,   0.008436,
  "dln_shelter",   "dln_shelter.l4",    0.1552791,   0.1418555,   1.095,   0.279917,
  "dln_shelter",   "dln_rent.l4",       0.2424147,   0.1447782,   1.674,   0.101487,
  "dln_shelter",   "const",            -0.0006622,   0.0031806,  -0.208,   0.836082,

  "dln_rent",      "dln_shelter.l1",   -0.005432,    0.139657,   -0.039,   0.96916,
  "dln_rent",      "dln_rent.l1",       0.429625,    0.141692,    3.032,   0.00415,
  "dln_rent",      "dln_shelter.l2",   -0.293987,    0.154825,   -1.899,   0.06447,
  "dln_rent",      "dln_rent.l2",       0.303079,    0.142501,    2.127,   0.03935,
  "dln_rent",      "dln_shelter.l3",    0.548302,    0.155062,    3.536,   0.00101,
  "dln_rent",      "dln_rent.l3",      -0.064697,    0.144714,   -0.447,   0.65712,
  "dln_rent",      "dln_shelter.l4",   -0.299647,    0.139240,   -2.152,   0.03719,
  "dln_rent",      "dln_rent.l4",      -0.272987,    0.142109,   -1.921,   0.06154,
  "dln_rent",      "const",             0.004787,    0.003122,    1.533,   0.13272
)

var_results %>%
  kable(digits = 4,
        caption = "Table 6: Estimation Results for VAR(4) Model") %>%
  kable_styling(latex_options = c("hold_position", "striped"))
```


```{r echo=FALSE}

forecast_manual <- tibble(
  date = as.Date(c(
    "2025-11-01","2025-12-01","2026-01-01","2026-02-01",
    "2026-03-01","2026-04-01","2026-05-01","2026-06-01",
    "2026-07-01","2026-08-01","2026-09-01","2026-10-01"
  )),

  shelter_pct_change = c(
     0.0005858856, -0.0023781026, -0.0079294741, -0.0087255219,
    -0.0050587514, -0.0016459912,  0.0018167043,  0.0058297687,
     0.0086221685,  0.0096954708,  0.0102135818,  0.0104865826
  ),

  rent_pct_change = c(
    -0.003916197,  0.001452075,  0.006674943,  0.012351132,
     0.013990338,  0.012669975,  0.010936973,  0.009363597,
     0.007533043,  0.006423320,  0.006302660,  0.006472655
  ),

  shelter_mean = c(
    85808.10, 85604.28, 84928.17, 84190.35,
    83765.53, 83627.76, 83779.83, 84269.67,
    84999.40, 85827.52, 86708.61, 87622.68
  ),

  rent_median = c(
    3934.561, 3940.279, 3966.668, 4015.964,
    4072.544, 4124.471, 4169.828, 4209.056,
    4240.883, 4268.211, 4295.197, 4323.089
  )
)

forecast_manual %>%
  kable(digits = 4,
    caption = "Table 9: 12-Month Forecasts: Percentage Changes and Levels"
  ) %>%
  kable_styling(latex_options = c("hold_position"))
```

